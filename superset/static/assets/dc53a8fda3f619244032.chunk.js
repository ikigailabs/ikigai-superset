"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[790],{50790:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o}),r(96540);var n=r(7349),a=r(32142),l=r(86444),i=r(85867),c=r(71194),s=r(17437);function o({height:e,width:t,echartOptions:r,formData:o,onContextMenu:u,setDataMask:d,filterState:h,emitCrossFilters:f,refs:v,coltypeMapping:p}){const m=e=>{if(null==e||!e.name||null==e||!e.col)return;const{name:t,col:r}=e,n=Object.values((null==h?void 0:h.selectedValues)||{});let a;return a=n.includes(t)?n.filter((e=>e!==t)):[t],{dataMask:{extraFormData:{filters:a.length?[{col:r,op:"IN",val:a}]:[]},filterState:{value:a.length?a:null,selectedValues:a.length?a:null}},isCurrentValueSelected:n.includes(t)}},g={click:e=>{var t;if(!f||!d)return;e.event.stop();const n=r.series[0].data.find((t=>t.id===e.data.id)),a=null==(t=m(n))?void 0:t.dataMask;a&&d(a)},contextmenu:e=>{if(u){e.event.stop();const t=e.event.event,i=r.series[0].data,s="node"===e.dataType?(t=>{const r=t.find((t=>t.id===e.data.id));if(null!=r&&r.name)return[{col:r.col,op:"==",val:r.name,formattedVal:r.name}]})(i):(t=>{var r,n;const a=null==(r=t.find((t=>t.id===e.data.source)))?void 0:r.name,l=null==(n=t.find((t=>t.id===e.data.target)))?void 0:n.name;if(a&&l)return[{col:o.source,op:"==",val:a,formattedVal:a},{col:o.target,op:"==",val:l,formattedVal:l}]})(i),d=i.find((t=>t.id===e.data.id));u(t.clientX,t.clientY,{drillToDetail:s,crossFilter:m(d),drillBy:d&&{filters:[{col:d.col,op:"==",val:d.name,formattedVal:(0,c.Wy)(d.name,{timeFormatter:(0,n.mo)(o.dateFormat),numberFormatter:(0,a.gV)(o.numberFormat),coltype:null==p?void 0:p[(0,l.A)(d.col)]})}],groupbyFieldName:d.col===o.source?"source":"target"}})}}};return(0,s.Y)(i.A,{refs:v,height:e,width:t,echartOptions:r,eventHandlers:g})}},85867:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(96540),a=r(90017),l=r(49805),i=r(17437);const c=a.A.div`
  height: ${({height:e})=>e};
  width: ${({width:e})=>e};
`;function s({width:e,height:t,echartOptions:r,eventHandlers:a,zrEventHandlers:s,selectedValues:o={},refs:u},d){const h=(0,n.useRef)(null);u&&(u.divRef=h);const f=(0,n.useRef)(),v=(0,n.useMemo)((()=>Object.keys(o)||[]),[o]),p=(0,n.useRef)([]);(0,n.useImperativeHandle)(d,(()=>({getEchartInstance:()=>f.current}))),(0,n.useEffect)((()=>{h.current&&(f.current||(f.current=(0,l.Ts)(h.current)),Object.entries(a||{}).forEach((([e,t])=>{var r,n;null==(r=f.current)||r.off(e),null==(n=f.current)||n.on(e,t)})),Object.entries(s||{}).forEach((([e,t])=>{var r,n;null==(r=f.current)||r.getZr().off(e),null==(n=f.current)||n.getZr().on(e,t)})),f.current.setOption(r,!0))}),[r,a,s]),(0,n.useEffect)((()=>{f.current&&(f.current.dispatchAction({type:"downplay",dataIndex:p.current.filter((e=>!v.includes(e)))}),v.length&&f.current.dispatchAction({type:"highlight",dataIndex:v}),p.current=v)}),[v]);const m=(0,n.useCallback)((({width:e,height:t})=>{f.current&&f.current.resize({width:e,height:t})}),[]);return(0,n.useEffect)((()=>(m({width:e,height:t}),()=>{var e;return null==(e=f.current)?void 0:e.dispose()})),[]),(0,n.useLayoutEffect)((()=>{m({width:e,height:t})}),[e,t,m]),(0,i.Y)(c,{ref:h,height:t,width:e})}const o=(0,n.forwardRef)(s)}}]);
//# sourceMappingURL=dc53a8fda3f619244032.chunk.js.map